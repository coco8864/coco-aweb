# トレース採取 #

> インストールおよびブラウザの設定が完了したところで簡単なトレースの採取方法を説明します。
> 以下動作確認用のサイトを利用して説明します。
```
 http://ph-sample.appspot.com
 https://ph-sample.appspot.com/
```
> 画像をクリックすると、１０枚の画面が切り替わります。また、counterは、リクエスト毎に１つづつカウントアップされるため、サーバからは同一のcounterを返却されることはありません。

> ## トレース採取 ##
> > ブラウザのアドレスバーに表示されるドメイン名の先頭に"ph."を付加すればトレース対象となります。
    1. 新規にブラウザを起動して以下のアドレスにリクエストしてください。
> > > http://ph.ph-sample.appspot.com/
    1. 認証画面が表示された場合には、認証情報を入力してください。
> > > 初期値はadmin/adminです。
    1. 動作確認用サイトが表示されます。
> > > 表示されたimageを数回clickして画像が切り替わる事を確認してください。


> ## トレース参照 ##
    1. ブラウザよりConsole表示してください。アドレスは以下です。
```
  http://${selfDomain}:${selfPort}/admin
```
> > > 初期値:http://IPアドレス:1280/admin
> > > 初期ログイン情報:admin/admin
    1. accessLogタブを開くとトレース採取フェーズでリクエストした内容が一覧されます。
> > > 表示されていない場合は、更新ボタンを押下して最新情報を表示してください。
    1. imgアイコンをclickするとレスポンス内容の画像が表示されます。
> > > 異なるimgアイコンを連続してclickすると画像が切り替わります。
    1. textアイコンをclickするとレスポンス内容が表示されます。
> > > レスポンスがgzip圧縮され表示内容が読めない事があります。その場合、表示されたダイアログ中のgzipチェックボックスをチェックしreloadボタンを押下するとhtml文書が表示されます。
    1. counterの内容等からトレース採取フェーズで採取したリクエストであることが確認できます。
    1. リクエストの詳細が見たい場合は、accessLog一覧中のid番号をclickしてください。
> > > traceタブに切り替わり、ヘッダ情報をはじめ当該リクエストに関するさまざまな情報が参照できます。


> ## リクエストの再実行 ##
    1. traceタブで再実行したいリクエストを表示してください。
    1. requestHeaderボタンで表示されるダイアログからrequestHeaderを編集することができます。
> > > requestBodyがある場合は、同様に編集することができます。編集後saveボタンで、編集内容が画面上に反映されます。
    1. traceタブのrequestボタンを押下すると表示内容のリクエストが再実行されます。
> > > しばらくすると、レスポンス内容でtraceタブが更新されます。
    1. counterの内容等から新規のリクエストであることが確認できます。

### 備考 ###

> 動作確認用のサイトは、Googole App Engine上動作しており、レスポンスが遅い場合があります。

<a href='Hidden comment: 
Googole App Engineのドメイン名は、プレフィクスをつけてもアクセスできるようです。
* 例）http://foo.ph-sample.appspot.com/

ph.phantom-test.appspot.comというドメインも物理的に存在している事になり、"Phantom" の例としてはあまり適切でなかったようです。
'></a>